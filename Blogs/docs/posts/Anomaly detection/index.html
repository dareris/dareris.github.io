<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rishav Khatiwada">
<meta name="dcterms.date" content="2023-11-19">

<title>dareris.github.io - Anomaly Detection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">dareris.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dareris" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Anomaly Detection</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">news</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rishav Khatiwada </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 19, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Importing the required libraries:</p>
<p>importing the dataset:</p>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>&lt;bound method NDFrame.head of                   Commodity        Date Unit  Minimum  Maximum  Average
SN                                                                     
0        Tomato Big(Nepali)  2013-06-16   Kg     35.0     40.0     37.5
1       Tomato Small(Local)  2013-06-16   Kg     26.0     32.0     29.0
2                Potato Red  2013-06-16   Kg     20.0     21.0     20.5
3              Potato White  2013-06-16   Kg     15.0     16.0     15.5
4        Onion Dry (Indian)  2013-06-16   Kg     28.0     30.0     29.0
...                     ...         ...  ...      ...      ...      ...
197156    Garlic Dry Nepali  2021-05-13   Kg    100.0    120.0    110.0
197157     Fish Fresh(Rahu)  2021-05-13   KG    270.0    280.0    275.0
197158  Fish Fresh(Bachuwa)  2021-05-13   KG    225.0    235.0    230.0
197159   Fish Fresh(Chhadi)  2021-05-13   KG    220.0    230.0    225.0
197160  Fish Fresh(Mungari)  2021-05-13   KG    240.0    250.0    245.0

[197161 rows x 6 columns]&gt;</code></pre>
</div>
</div>
<p>Only selecting the data January 1st 2020 onward which we are interested in:</p>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Commodity</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Unit</th>
<th data-quarto-table-cell-role="th">Minimum</th>
<th data-quarto-table-cell-role="th">Maximum</th>
<th data-quarto-table-cell-role="th">Average</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SN</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">157524</td>
<td>Tomato Big(Nepali)</td>
<td>2020-01-02</td>
<td>Kg</td>
<td>65.0</td>
<td>70.0</td>
<td>67.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">157525</td>
<td>Tomato Big(Indian)</td>
<td>2020-01-02</td>
<td>Kg</td>
<td>65.0</td>
<td>70.0</td>
<td>67.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157526</td>
<td>Tomato Small(Local)</td>
<td>2020-01-02</td>
<td>Kg</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">157527</td>
<td>Tomato Small(Tunnel)</td>
<td>2020-01-02</td>
<td>Kg</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157528</td>
<td>Tomato Small(Indian)</td>
<td>2020-01-02</td>
<td>KG</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197156</td>
<td>Garlic Dry Nepali</td>
<td>2021-05-13</td>
<td>Kg</td>
<td>100.0</td>
<td>120.0</td>
<td>110.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197157</td>
<td>Fish Fresh(Rahu)</td>
<td>2021-05-13</td>
<td>KG</td>
<td>270.0</td>
<td>280.0</td>
<td>275.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197158</td>
<td>Fish Fresh(Bachuwa)</td>
<td>2021-05-13</td>
<td>KG</td>
<td>225.0</td>
<td>235.0</td>
<td>230.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197159</td>
<td>Fish Fresh(Chhadi)</td>
<td>2021-05-13</td>
<td>KG</td>
<td>220.0</td>
<td>230.0</td>
<td>225.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197160</td>
<td>Fish Fresh(Mungari)</td>
<td>2021-05-13</td>
<td>KG</td>
<td>240.0</td>
<td>250.0</td>
<td>245.0</td>
</tr>
</tbody>
</table>

<p>39637 rows × 6 columns</p>
</div>
</div>
</div>
<p>Saving the commodity and date columns in its original form so that it can be used later as we will be converting them using label encoder.</p>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x154e600d2d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-6-output-2.png" width="583" height="411"></p>
</div>
</div>
<p>Identifying the missing values:</p>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Commodity    0.0
Date         0.0
Unit         0.0
Minimum      0.0
Maximum      0.0
Average      0.0
dtype: float64</code></pre>
</div>
</div>
<p>Describing the data to know the details of our features:</p>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Minimum</th>
<th data-quarto-table-cell-role="th">Maximum</th>
<th data-quarto-table-cell-role="th">Average</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>39637</td>
<td>39637.000000</td>
<td>39637.000000</td>
<td>39637.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2020-09-27 03:02:53.020158208</td>
<td>100.141787</td>
<td>110.051518</td>
<td>105.096652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2020-01-02 00:00:00</td>
<td>6.000000</td>
<td>8.000000</td>
<td>7.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2020-05-25 00:00:00</td>
<td>40.000000</td>
<td>50.000000</td>
<td>45.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2020-10-19 00:00:00</td>
<td>70.000000</td>
<td>80.000000</td>
<td>75.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2021-02-02 00:00:00</td>
<td>120.000000</td>
<td>130.000000</td>
<td>125.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2021-05-13 00:00:00</td>
<td>1800.000000</td>
<td>2000.000000</td>
<td>1900.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>92.813213</td>
<td>97.867785</td>
<td>95.277303</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\poude\AppData\Local\Temp\ipykernel_20340\1442402836.py:1: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `histplot` (an axes-level function for histograms).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data["Average"])</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;Axes: xlabel='Average', ylabel='Density'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-9-output-3.png" width="615" height="429"></p>
</div>
</div>
<p>From this we can see that the data is right skewed.</p>
<p>To perform the anomaly detection we can use different models. Here, we will discuss some of the models but eventually we will be using DBSCAN.</p>
<p>First, we test the z_score to find anomaly.</p>
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>               Commodity       Date Unit  Minimum  Maximum  Average
SN                                                                 
157571  Mushroom(Button) 2020-01-02   KG    330.0    340.0    335.0
157598        Chilli Dry 2020-01-02   Kg    390.0    400.0    395.0
157657  Mushroom(Button) 2020-01-03   KG    340.0    350.0    345.0
157684        Chilli Dry 2020-01-03   Kg    390.0    400.0    395.0
157742  Mushroom(Button) 2020-01-04   KG    320.0    330.0    325.0
...                  ...        ...  ...      ...      ...      ...
197054        Strawberry 2021-05-12   Kg    400.0    500.0    450.0
197056        Chilli Dry 2021-05-12   Kg    320.0    330.0    325.0
197114         Asparagus 2021-05-13   Kg   1000.0   1050.0   1025.0
197145        Strawberry 2021-05-13   Kg    450.0    500.0    475.0
197147        Chilli Dry 2021-05-13   Kg    320.0    330.0    325.0

[2208 rows x 6 columns]</code></pre>
</div>
</div>
<p>Second, we use interquartile range(IQR) for anomaly detection.</p>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>               Commodity       Date Unit  Minimum  Maximum  Average
SN                                                                 
157571  Mushroom(Button) 2020-01-02   KG    330.0    340.0    335.0
157575            Celery 2020-01-02   Kg    270.0    280.0    275.0
157576          Parseley 2020-01-02   Kg    270.0    280.0    275.0
157578              Mint 2020-01-02   Kg    270.0    280.0    275.0
157583           Gundruk 2020-01-02   Kg    280.0    290.0    285.0
...                  ...        ...  ...      ...      ...      ...
197130       Pomegranate 2021-05-13   Kg    280.0    300.0    290.0
197141     Pear(Chinese) 2021-05-13   Kg    250.0    260.0    255.0
197145        Strawberry 2021-05-13   Kg    450.0    500.0    475.0
197147        Chilli Dry 2021-05-13   Kg    320.0    330.0    325.0
197157  Fish Fresh(Rahu) 2021-05-13   KG    270.0    280.0    275.0

[4039 rows x 6 columns]</code></pre>
</div>
</div>
<p>Selecting the numerical features of which we want to detect anomalies:</p>
<div class="cell" data-execution_count="11">
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([1, 1, 1, ..., 1, 1, 1])</code></pre>
</div>
</div>
<p>And performing the element-wise comparison</p>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(array([   47,    74,   133, ..., 39590, 39621, 39623], dtype=int64),)</code></pre>
</div>
</div>
<p>Making our earlier scatter plot more beautiful:</p>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x154ed258a90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-14-output-2.png" width="583" height="411"></p>
</div>
</div>
<p>Converting our Date features to a numerical format and converting that timestamp into an integer:</p>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\poude\AppData\Local\Temp\ipykernel_20340\2041701408.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data["Date"] = pd.to_datetime(data["Date"]).apply(lambda x: x.timestamp())
C:\Users\poude\AppData\Local\Temp\ipykernel_20340\2041701408.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data["Date"] = data["Date"].astype(int)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Commodity</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Unit</th>
<th data-quarto-table-cell-role="th">Minimum</th>
<th data-quarto-table-cell-role="th">Maximum</th>
<th data-quarto-table-cell-role="th">Average</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SN</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">157524</td>
<td>Tomato Big(Nepali)</td>
<td>1577923200</td>
<td>Kg</td>
<td>65.0</td>
<td>70.0</td>
<td>67.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">157525</td>
<td>Tomato Big(Indian)</td>
<td>1577923200</td>
<td>Kg</td>
<td>65.0</td>
<td>70.0</td>
<td>67.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157526</td>
<td>Tomato Small(Local)</td>
<td>1577923200</td>
<td>Kg</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">157527</td>
<td>Tomato Small(Tunnel)</td>
<td>1577923200</td>
<td>Kg</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157528</td>
<td>Tomato Small(Indian)</td>
<td>1577923200</td>
<td>KG</td>
<td>40.0</td>
<td>50.0</td>
<td>45.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>TO maintain the consistency, we choose to use standard scalar to scale our data:</p>
<p>Reducing the dimensions of our data to 2 using PCA:</p>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([[-0.79822404,  1.77395273],
       [-0.79822404,  1.77395273],
       [-1.20721222,  1.74699569],
       ...,
       [ 2.36499445, -1.39243537],
       [ 2.27428372, -1.39829777],
       [ 2.63712665, -1.37484816]])</code></pre>
</div>
</div>
<p>Performing the DBSCAN clustering using PCA component 1 and 2 each representing one dimension.</p>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-18-output-1.png" width="823" height="523"></p>
</div>
</div>
<p>To see the performance of our Clustering model, we use Silhouette Score:</p>
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette Score: 0.8130632448850409</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Commodity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.798224</td>
<td>1.773953</td>
<td>0</td>
<td>2020-01-02</td>
<td>Tomato Big(Nepali)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.798224</td>
<td>1.773953</td>
<td>0</td>
<td>2020-01-02</td>
<td>Tomato Big(Indian)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.207212</td>
<td>1.746996</td>
<td>0</td>
<td>2020-01-02</td>
<td>Tomato Small(Local)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.207212</td>
<td>1.746996</td>
<td>0</td>
<td>2020-01-02</td>
<td>Tomato Small(Tunnel)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.207212</td>
<td>1.746996</td>
<td>0</td>
<td>2020-01-02</td>
<td>Tomato Small(Indian)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39632</td>
<td>0.186357</td>
<td>-1.534286</td>
<td>0</td>
<td>2021-05-13</td>
<td>Garlic Dry Nepali</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39633</td>
<td>3.181391</td>
<td>-1.339674</td>
<td>0</td>
<td>2021-05-13</td>
<td>Fish Fresh(Rahu)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39634</td>
<td>2.364994</td>
<td>-1.392435</td>
<td>0</td>
<td>2021-05-13</td>
<td>Fish Fresh(Bachuwa)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39635</td>
<td>2.274284</td>
<td>-1.398298</td>
<td>0</td>
<td>2021-05-13</td>
<td>Fish Fresh(Chhadi)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39636</td>
<td>2.637127</td>
<td>-1.374848</td>
<td>0</td>
<td>2021-05-13</td>
<td>Fish Fresh(Mungari)</td>
</tr>
</tbody>
</table>

<p>39637 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-21-output-1.png" width="925" height="515"></p>
</div>
</div>
<p>It is difficult to visualize individual data with so much compact cluster. So, let’s try to do it the other way where we break our clusters and visualize only the one that is important to us.</p>
<p>Here, these are the anomaly that we wanted to see.</p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-22-output-1.png" width="641" height="441"></p>
</div>
</div>
<p>Let’s visualize it more clearly the other way:</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-23-output-1.png" width="932" height="539"></p>
</div>
</div>
<p>We can see that the Vegetables like Asparagus and Mushroom, spice like Akbare Green Chilli, Fruits like Strawberry which are less consumed in Nepal and are usually more expensive than other vegetables see the anomalies in price. This is simply because people are usually unaware of their actual price as these foods are less consumed in Kathmandu and the whole sellers and retailers take an advantage of this and rise their price citing various reasons like weather, change in fuel price, etc. The suprising commodity that features in this list is Chinese Garlic, which is a popular and most sold spice in Kathmandu. The reason may be the sellers sometime increase the price by creating fake shortage of this product for more profit by saying there has been some problem during import as it is imported from China. This is not very uncommon thing there. So, the concerned authority should really need to pay attention to the sudden increase of the off seasonal and less consumed commodity in addition to the regular ones.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>